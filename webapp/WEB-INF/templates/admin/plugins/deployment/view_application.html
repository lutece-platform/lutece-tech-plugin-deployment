<script src="js/plugins/deployment/selectbox.js" type="text/javascript"></script>
<script src="js/plugins/deployment/deployment.js" type="text/javascript"></script>

<div class="row-fluid" >

    <legend>#i18n{deployment.form_init_deploy_application.table_label}</legend>

    <#if error_message?has_content>
    ${error_message}
    <a class="btn btn-primary btn-mini" href="jsp/admin/user/ModifyUser.jsp?id_user=${id_user}"  title="#i18n{deployment.create_application.action_modify_user_account}" >
        <i class="glyphicon glyphicon-edit"></i> 
    </a>
    <#else>
    <div class="well col-xs-12 col-sm-6 col-md-6" >
        <fieldset>
            <legend>Application</legend>

            <p><strong>#i18n{deployment.deploy_application_process.label_code}:</strong>${application.code}</p> 
            <p><strong>#i18n{deployment.deploy_application_process.label_name} :</strong>${application.name}</p> 
        </fieldset> 	
    </div>    
    <div class="row" >

        <table class="table table-striped table-condensed">
            <#list environment_list as environment>
            <tr><td colspan="4"><h2>${environment.name}</h2></td></tr>
            <tr><td colspan="4"><h3>SERVEURS TOMCAT</h3></td></tr>
            <#assign listServerApplicationInstance = server_instance_map_tomcat[environment.code!]! /> 
            <tr>
                <th>Code</th>
                <th>Nom</th>
                <th>Etat</th>
                <th>Actions</th>
            </tr>
            <#list listServerApplicationInstance as serverApplicationInstance>
            <tr>
                <td>${serverApplicationInstance.code}</td>
                <td>${serverApplicationInstance.name}</td>
                <td>    
                    <#if serverApplicationInstance.status?has_content && serverApplicationInstance.status?has_content && serverApplicationInstance.status==1>
                    <span class="label label-success"><i class="glyphicon glyphicon-ok-sign"></i> #i18n{portal.util.labelEnabled}</span>
                    <#else>
                    <span class="label label-important"><i class="glyphicon glyphicon-remove-sign"></i> #i18n{portal.util.labelDisabled}</span>
                    </#if>
                <td> 
                    <#list serverApplicationInstance.listServerApplicationAction as action >  
                        <#if (!action.status?exists)||(action.status?exists &&  serverApplicationInstance.status?has_content &&serverApplicationInstance.status==action.status)>
                        <a class="btn btn-primary btn-mini" href="jsp/admin/plugins/deployment/RunAction.jsp?code_action=${action.code}&code_server_application=${serverApplicationInstance.code}" title="${action.name}" >
                            <i class="${action.iconCssClass}"></i>
                        </a>	
                        </#if>
                    </#list>	
                </td>
            </tr>				
            </#list>
            <tr><td colspan="4"><h3>SERVEURS MYSQL</h3></td></tr>
            <#assign listServerApplicationInstanceMysql = server_instance_map_mysql[environment.code!]! /> 
            <tr>
                <th>Code</th>
                <th>Nom</th>
                <th>Etat</th>
                <th>Actions</th>
            </tr>
            <#list listServerApplicationInstanceMysql as serverApplicationInstance>
            <tr>
                <td>${serverApplicationInstance.code}</td>
                <td>${serverApplicationInstance.name}</td>
                <td>    
                    <#if serverApplicationInstance.status?has_content && serverApplicationInstance.status?has_content && serverApplicationInstance.status==1>
                    <span class="label label-success"><i class="glyphicon glyphicon-ok-sign"></i> #i18n{portal.util.labelEnabled}</span>
                    <#else>
                    <span class="label label-important"><i class="glyphicon glyphicon-remove-sign"></i> #i18n{portal.util.labelDisabled}</span>
                    </#if>
                <td> 
                    <#list serverApplicationInstance.listServerApplicationAction as action >  
                        <#if (!action.status?exists)||(action.status?exists && serverApplicationInstance.status?has_content &&  serverApplicationInstance.status==action.status)>
                        <a class="btn btn-primary btn-mini" href="jsp/admin/plugins/deployment/RunAction.jsp?code_action=${action.code}&code_server_application=${serverApplicationInstance.code}" title="${action.name}" >
                            <i class="${action.iconCssClass}"></i>
                        </a>	
                        </#if>
                    </#list>	
                </td>
            </tr>								
            </#list>
            <tr><td colspan="4"><h3>SERVEURS HTTPD</h3></td></tr>
            <#assign listServerApplicationInstanceHttpd = server_instance_map_httpd[environment.code!]! /> 
            <tr>
                <th>Code</th>
                <th>Nom</th>
                <th>Etat</th>
                <th>Actions</th>
            </tr>
            <#list listServerApplicationInstanceHttpd as serverApplicationInstance>
            <tr>
                <td>${serverApplicationInstance.code}</td>
                <td>${serverApplicationInstance.name}</td>
                <td>    
                    <#if serverApplicationInstance.status?has_content && serverApplicationInstance.status?has_content && serverApplicationInstance.status==1>
                    <span class="label label-success"><i class="glyphicon glyphicon-ok-sign"></i> #i18n{portal.util.labelEnabled}</span>
                    <#else>
                    <span class="label label-important"><i class="glyphicon glyphicon-remove-sign"></i> #i18n{portal.util.labelDisabled}</span>
                    </#if>
                <td> 
                    <#list serverApplicationInstance.listServerApplicationAction as action >  
                        <#if (!action.status?exists)||(action.status?exists && serverApplicationInstance.status?has_content && serverApplicationInstance.status==action.status)>
                        <a class="btn btn-primary btn-mini" href="jsp/admin/plugins/deployment/RunAction.jsp?code_action=${action.code}&code_server_application=${serverApplicationInstance.code}" title="${action.name}" >
                            <i class="${action.iconCssClass}"></i>
                        </a>	
                        </#if>
                    </#list>	
                </td>
            </tr>					
            </#list>
            </tbody>
        </table>
        </#list>
    </div>	   
    </#if>
</div>